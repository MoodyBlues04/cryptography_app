<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Процесс формирования и проверки подписи по ГОСТ Р 34.10-2018</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f9f9f9;
            color: #333;
        }

        h1, h2, h3 {
            color: #2c3e50;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .code {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            font-family: "Courier New", monospace;
            overflow-x: auto;
        }

        .step {
            margin-bottom: 20px;
        }

        .step p {
            margin: 10px 0;
        }

        .highlight {
            color: #e74c3c;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Процесс формирования и проверки подписи по ГОСТ Р 34.10-2018</h1>

    <a href="/gost_34_10_2018">Реализация алгоритма</a>
    <br>
    <a href="https://meganorm.ru/Data2/1/4293732/4293732954.pdf" target="_blank">Стандарт ГОСТ</a>

    <p>Этот документ объясняет процессы формирования и проверки электронной цифровой подписи (ЭЦП) по стандарту ГОСТ Р
        34.10-2018, который основан на криптографии эллиптических кривых.</p>

    <div class="step">
        <h2>1. Обзор процесса формирования подписи</h2>
        <p>Процесс формирования подписи включает следующие шаги:</p>
        <ol>
            <li>Вычислить хэш сообщения.</li>
            <li>Преобразовать хэш в целое число и взять его по модулю q.</li>
            <li>Сгенерировать случайное число k.</li>
            <li>Вычислить точку эллиптической кривой C = kP.</li>
            <li>Вычислить r = x_C mod q.</li>
            <li>Вычислить s = (rd + ke) mod q.</li>
            <li>Сформировать подпись как пару (r, s).</li>
        </ol>
    </div>

    <div class="step">
        <h2>2. Проверка пользовательского ввода</h2>
        <ol>
            <li><strong>p</strong> - простое число.</li>
            <li><strong>a</strong> и <strong>b</strong> задают эллиптическую кривую.
                <ul>
                    <li><code>(4 * a^3 + 27 * b^2) = 0 (mod p)</code>.</li>
                    <li><code>1728 * 4 * a^3 / 4 * a^3 + 27 * b^2 != 0, 1728 (mod p)</code>.</li>
                </ul>
            </li>
            <li><strong>m</strong>: <code>p + 1 - 2 * sqrt(p) <= m <= p + 1 + 2 * sqrt(p)</code></li>
            <li><strong>q</strong> - простой делитель <code>m</code></li>
            <li><strong>P</strong> - базовая точка.
                <ul>
                    <li><code>P_y^2 = P_x^3 + P_x * a + b (mod p)</code> - то есть <code>P</code> лежит на кривой</li>
                    <li><code>P != O</code>, где <code>O</code> - нейтральный по сложению элемент</li>
                    <li><code>qP = O</code></li>
                </ul>
            </li>
            <li><strong>private_key</strong> - приватный ключ. <code>1 <= private_key < q</code></li>
            <li><strong>public_key</strong> - публичный ключ. <code>public_key = private_key * P</code></li>
        </ol>
    </div>

    <div class="step">
        <h2>3. Подробные шаги формирования подписи</h2>
        <h3>Шаг 1: Вычислить хэш сообщения</h3>
        <p>Сообщение M хэшируется с использованием хэш-функции ГОСТ Р 34.11-2012. Пусть h = hash(M).</p>

        <h3>Шаг 2: Преобразовать хэш в целое число и взять его по модулю q</h3>
        <p>Преобразуйте хэш h в целое число α. Вычислите e = α mod q. Если e = 0, установите e = 1.</p>

        <h3>Шаг 3: Сгенерировать случайное число k</h3>
        <p>Сгенерируйте случайное целое число k, такое что 0 < k < q.</p>

        <h3>Шаг 4: Вычислить точку эллиптической кривой C = kP</h3>
        <p>Умножьте базовую точку P на случайное число k, чтобы получить точку C.</p>

        <h3>Шаг 5: Вычислить r = x_C mod q</h3>
        <p>Извлеките x-координату точки C и возьмите ее по модулю q. Если r = 0, вернитесь к шагу 3 и сгенерируйте новое
            k.</p>

        <h3>Шаг 6: Вычислить s = (rd + ke) mod q</h3>
        <p>Используйте закрытый ключ d, случайное число k и значение e для вычисления s. Если s = 0, вернитесь к шагу 3
            и сгенерируйте новое k.</p>

        <h3>Шаг 7: Сформировать подпись</h3>
        <p>Подпись представляет собой пару (r, s).</p>
    </div>

    <div class="step">
        <h2>4. Процесс проверки подписи</h2>
        <p>Процесс проверки подписи включает следующие шаги:</p>
        <ol>
            <li>Проверить, что 0 < r < q и 0 < s < q.</li>
            <li>Вычислить хэш сообщения.</li>
            <li>Преобразовать хэш в целое число и взять его по модулю q.</li>
            <li>Вычислить модульный обратный элемент s по модулю q.</li>
            <li>Вычислить промежуточные значения z1 и z2.</li>
            <li>Вычислить точку эллиптической кривой C = z1 * P + z2 * Q.</li>
            <li>Извлечь R = x_C mod q.</li>
            <li>Проверить, что R = r. Если да, подпись верна.</li>
        </ol>
    </div>

    <div class="step">
        <h2>5. Подробные шаги проверки подписи</h2>
        <h3>Шаг 1: Проверить корректность r и s</h3>
        <p>Убедитесь, что 0 < r < q и 0 < s < q. Если это не так, подпись недействительна.</p>

        <h3>Шаг 2: Вычислить хэш сообщения</h3>
        <p>Вычислите хэш сообщения M с использованием хэш-функции ГОСТ Р 34.11-2012. Пусть h = hash(M).</p>

        <h3>Шаг 3: Преобразовать хэш в целое число и взять его по модулю q</h3>
        <p>Преобразуйте хэш h в целое число α. Вычислите e = α mod q. Если e = 0, установите e = 1.</p>

        <h3>Шаг 4: Вычислить модульный обратный элемент s по модулю q</h3>
        <p>Вычислите v = s^(-1) mod q.</p>

        <h3>Шаг 5: Вычислить промежуточные значения z1 и z2</h3>
        <p>Вычислите z1 = (e * v) mod q и z2 = (-r * v) mod q.</p>

        <h3>Шаг 6: Вычислить точку эллиптической кривой C = z1 * P + z2 * Q</h3>
        <p>Умножьте базовую точку P на z1 и открытый ключ Q на z2, затем сложите результаты.</p>

        <h3>Шаг 7: Извлечь R = x_C mod q</h3>
        <p>Извлеките x-координату точки C и возьмите ее по модулю q.</p>

        <h3>Шаг 8: Проверить подпись</h3>
        <p>Если R = r, подпись действительна. В противном случае подпись недействительна.</p>
    </div>
</div>
</body>
</html>